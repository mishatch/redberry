<div class="wrapper">
  <div>
    <div>
      <div class="col">
        <div ngbDropdown class="d-inline-block" #regionDropdown="ngbDropdown">
          <button type="button" class="btn btn-outline-primary dropdown-toggle-btn  firago-500" id="region" ngbDropdownToggle>
            რეგიონი
          </button>
          <div ngbDropdownMenu aria-labelledby="region" class="region-dropdown">
            <h5 class="firago-500">რეგიონის მიხედვით</h5>
            <div class="checkbox-wrapper">
              @for (region of regions; track region){
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    [value]="region.id"
                    [id]="region.name"
                    [(ngModel)]="selectedRegionIds[region.id]"

                  >
                  <label class="form-check-label" [for]="region.name">
                    {{ region.name }}
                  </label>
                </div>
              }
            </div>
            <button class="primary-button" (click)="onSubmitRegion(); regionDropdown.close()" [class.is-disabled]="!hasSelectedRegions()">არჩევა</button>
          </div>
        </div>
      </div>
      <div class="col">
        <div ngbDropdown class="d-inline-block" #priceDropdown="ngbDropdown">
          <button type="button" class="btn btn-outline-primary dropdown-toggle-btn  firago-500" id="price" ngbDropdownToggle>
            საფასო კატეგორია
          </button>
          <div ngbDropdownMenu aria-labelledby="price" class="price-dropdown">
            <h5 class="firago-500">ფასის მიხედვით</h5>
            <form [formGroup]="priceForm">
              <div class="price-inputs">
                <input
                  type="text"
                  class="form-control"
                  placeholder="დან"
                  formControlName="minPrice"
                  [class.invalid]="priceForm.errors"
                >
                <span class="gel-icon">
                  ₾
                </span>
                <input
                  type="text"
                  class="form-control"
                  placeholder="მდე"
                  formControlName="maxPrice"
                  [class.invalid]="priceForm.errors"
                >
                <span class="gel-icon">
                  ₾
                </span>
              </div>
              @if (priceForm.errors){
                <small class="firago-400">
                  ჩაწერეთ ვალიდური მონაცემები
                </small>
              }
            </form>
            <div class="prices">
              <div class="min-price">
                <h6>მინ. ფასი</h6>
                <button class="btn" (click)="setMinPrice(50000)">50, 000</button>
                <button class="btn" (click)="setMinPrice(100000)">100, 000</button>
                <button class="btn" (click)="setMinPrice(150000)">150, 000</button>
                <button class="btn" (click)="setMinPrice(200000)">200, 000</button>
                <button class="btn" (click)="setMinPrice(300000)">300, 000</button>
              </div>
              <div class="max-price">
                <h6>მაქს. ფასი</h6>
                <button class="btn" (click)="setMaxPrice(50000)">50, 000</button>
                <button class="btn" (click)="setMaxPrice(100000)">100, 000</button>
                <button class="btn" (click)="setMaxPrice(150000)">150, 000</button>
                <button class="btn" (click)="setMaxPrice(200000)">200, 000</button>
                <button class="btn" (click)="setMaxPrice(300000)">300, 000</button>
              </div>
            </div>
            <button
              class="primary-button"
              (click)="onSubmitPrice();
              priceDropdown.close()"
              [disabled]="(!minPrice?.value || !maxPrice?.value) || priceForm.invalid"
              [class.is-disabled]="(!minPrice?.value || !maxPrice?.value) || priceForm.invalid"
            >
              არჩევა
            </button>
          </div>
        </div>
      </div>
      <div class="col">
        <div ngbDropdown class="d-inline-block" #areaDropdown="ngbDropdown">
          <button type="button" class="btn btn-outline-primary dropdown-toggle-btn  firago-500" id="area" ngbDropdownToggle>
            ფართობი
          </button>
          <div ngbDropdownMenu aria-labelledby="area" class="area-dropdown">
            <h5 class="firago-500">ფართობის მიხედვით მიხედვით</h5>
            <form [formGroup]="areaForm">
              <div class="area-inputs">
                <input
                  type="text"
                  class="form-control"
                  placeholder="დან"
                  formControlName="minArea"
                  [class.invalid]="areaForm.errors"
                >
                <span class="area-icon">
                  მ²
                </span>
                <input
                  type="text"
                  class="form-control"
                  placeholder="მდე"
                  formControlName="maxArea"
                  [class.invalid]="areaForm.errors"
                >
                <span class="area-icon">
                  მ²
                </span>
              </div>
              @if (areaForm.errors){
                <small class="firago-400">
                  ჩაწერეთ ვალიდური მონაცემები
                </small>
              }
            </form>
            <div class="areas">
              <div class="min-area">
                <h6>მინ. მ²</h6>
                <button class="btn" (click)="setMinArea(50)">50</button>
                <button class="btn" (click)="setMinArea(100)">100</button>
                <button class="btn" (click)="setMinArea(150)">150</button>
                <button class="btn" (click)="setMinArea(200)">200</button>
                <button class="btn" (click)="setMinArea(300)">300</button>
              </div>
              <div class="max-area">
                <h6>მაქს. მ²</h6>
                <button class="btn" (click)="setMaxArea(50)">50</button>
                <button class="btn" (click)="setMaxArea(100)">100</button>
                <button class="btn" (click)="setMaxArea(150)">150</button>
                <button class="btn" (click)="setMaxArea(200)">200</button>
                <button class="btn" (click)="setMaxArea(300)">300</button>
              </div>
            </div>
            <button
              class="primary-button"
              (click)="onSubmitArea(); areaDropdown.close()"
              [disabled]="(!minArea?.value || !maxArea?.value) || areaForm.invalid"
              [class.is-disabled]="(!minArea?.value || !maxArea?.value) || areaForm.invalid"
            >
              არჩევა
            </button>
          </div>
        </div>
      </div>
      <div class="col">
        <div ngbDropdown class="d-inline-block" #bedroomsDropdown="ngbDropdown">
          <button type="button" class="btn btn-outline-primary dropdown-toggle-btn  firago-500" id="bedrooms" ngbDropdownToggle>
            საძინებლების რაოდენობა
          </button>
          <div ngbDropdownMenu aria-labelledby="bedrooms" class="bedrooms-dropdown">
            <h5 class="firago-500">საძინებლების რაოდენობა</h5>
            <input type="number" class="form-control" [(ngModel)]="bedrooms">
            @if ((bedrooms! < 1 && bedrooms !== null)){
              <small class="firago-400 bedroom-alert">
                ჩაწერეთ ვალიდური მონაცემები
              </small>
            }
            <button
              class="primary-button"
              (click)="onSubmitBedrooms(); bedroomsDropdown.close()"
              [disabled]="(bedrooms! < 1 || bedrooms === null)"
              [class.is-disabled]="(bedrooms! < 1 || bedrooms === null)"
            >
              არჩევა
            </button>
          </div>
        </div>
      </div>
    </div>
    <div class="filter-options">
      @if (filterOptions.regionIds.length > 0){
        @for (regionId of filterOptions.regionIds; track regionId){
          <div class="filter-option">
            {{ getRegionNameById(regionId) }}
            <span (click)="removeRegion(regionId)">
              <svg width="14" height="15" viewBox="0 0 14 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M10.5 4L3.5 11" stroke="#354451" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M3.5 4L10.5 11" stroke="#354451" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
          </div>
        }
      }
      @if (filterOptions.priceMax && filterOptions.priceMin){
        <div class="filter-option">
          {{ filterOptions.priceMin }}₾ - {{ filterOptions.priceMax }}₾
          <span (click)="onClearPrice()">
        <svg width="14" height="15" viewBox="0 0 14 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M10.5 4L3.5 11" stroke="#354451" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M3.5 4L10.5 11" stroke="#354451" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </span>
        </div>
      }
      @if (filterOptions.areaMax && filterOptions.areaMin){
        <div class="filter-option">
          {{ filterOptions.areaMin }}მ² - {{ filterOptions.areaMax }}მ²
          <span (click)="onClearArea()">
        <svg width="14" height="15" viewBox="0 0 14 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M10.5 4L3.5 11" stroke="#354451" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M3.5 4L10.5 11" stroke="#354451" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </span>
        </div>
      }
      @if (filterOptions.bedrooms){
        <div class="filter-option">
          {{ bedrooms }}
          <span (click)="onClearBedrooms()">
        <svg width="14" height="15" viewBox="0 0 14 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M10.5 4L3.5 11" stroke="#354451" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M3.5 4L10.5 11" stroke="#354451" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </span>
        </div>
      }
      @if (filterOptions.bedrooms || filterOptions.areaMax || filterOptions.areaMin || filterOptions.priceMax || filterOptions.priceMin || filterOptions.regionIds.length > 0){
          <span class="clear-all firago-400" (click)="clearFilter()">
            გასუფთავება
          </span>
      }
    </div>
  </div>
  <div>
    <a routerLink="/add-listing" class="primary-button">
      <svg width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12.4997 7.41439H7.91634V11.9977C7.91634 12.2408 7.81976 12.474 7.64786 12.6459C7.47595 12.8178 7.24279 12.9144 6.99967 12.9144C6.75656 12.9144 6.5234 12.8178 6.35149 12.6459C6.17958 12.474 6.08301 12.2408 6.08301 11.9977V7.41439H1.49967C1.25656 7.41439 1.0234 7.31781 0.851493 7.1459C0.679585 6.97399 0.583008 6.74084 0.583008 6.49772C0.583008 6.25461 0.679585 6.02145 0.851493 5.84954C1.0234 5.67763 1.25656 5.58105 1.49967 5.58105H6.08301V0.997721C6.08301 0.754606 6.17958 0.521448 6.35149 0.34954C6.5234 0.177632 6.75656 0.0810547 6.99967 0.0810547C7.24279 0.0810547 7.47595 0.177632 7.64786 0.34954C7.81976 0.521448 7.91634 0.754606 7.91634 0.997721V5.58105H12.4997C12.7428 5.58105 12.9759 5.67763 13.1479 5.84954C13.3198 6.02145 13.4163 6.25461 13.4163 6.49772C13.4163 6.74084 13.3198 6.97399 13.1479 7.1459C12.9759 7.31781 12.7428 7.41439 12.4997 7.41439Z" fill="#F93B1D"/>
      </svg>
      ლისტინგის დამატება
    </a>
    <button (click)="openAgentModal()" class="secondary-button">
      <svg width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12.4997 7.41439H7.91634V11.9977C7.91634 12.2408 7.81976 12.474 7.64786 12.6459C7.47595 12.8178 7.24279 12.9144 6.99967 12.9144C6.75656 12.9144 6.5234 12.8178 6.35149 12.6459C6.17958 12.474 6.08301 12.2408 6.08301 11.9977V7.41439H1.49967C1.25656 7.41439 1.0234 7.31781 0.851493 7.1459C0.679585 6.97399 0.583008 6.74084 0.583008 6.49772C0.583008 6.25461 0.679585 6.02145 0.851493 5.84954C1.0234 5.67763 1.25656 5.58105 1.49967 5.58105H6.08301V0.997721C6.08301 0.754606 6.17958 0.521448 6.35149 0.34954C6.5234 0.177632 6.75656 0.0810547 6.99967 0.0810547C7.24279 0.0810547 7.47595 0.177632 7.64786 0.34954C7.81976 0.521448 7.91634 0.754606 7.91634 0.997721V5.58105H12.4997C12.7428 5.58105 12.9759 5.67763 13.1479 5.84954C13.3198 6.02145 13.4163 6.25461 13.4163 6.49772C13.4163 6.74084 13.3198 6.97399 13.1479 7.1459C12.9759 7.31781 12.7428 7.41439 12.4997 7.41439Z" fill="#F93B1D"/>
      </svg>
      აგენტის დამატება
    </button>
  </div>
</div>

<app-agent-modal #agentModal></app-agent-modal>
